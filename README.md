# puppet-rethinkdb
A [Puppet](https://puppetlabs.com/) module for
[RethinkDB](http://www.rethinkdb.com/).

## Dependencies
[Hey listen!](./Modulefile)

## Limitations
* Only works under Ubuntu. Sorry.
* Only supports a single instance per machine
* You must specify a user/group for the service (leaving it
  blank is not an option)

## Usage
With all the defaults:

```puppet
include rethinkdb
```

With custom parameters:

```puppet
# these are the default values for each parameter
class { 'rethinkdb':
	rethinkdb_user => 'user'
	rethinkdb_group => 'user',
	instance_name => 'default',
	driver_port => 28015,
	http_port => 8080,
	cluster_port => 29015,
	rethinkdb_bind => 'all',
	rethinkdb_join => undef # e.g. "mymachine:29015"
}
```
The above will generate the following conf file
(in `/etc/rethinkdb/instances.d/default.conf`):

```
# Automatically generated by puppet
runuser=rethinkdb
rungroup=rethinkdb
directory=/var/lib/rethinkdb/instances.d/default
pid-file=/var/run/rethinkdb/instances.d/default.pid
driver-port=28015
cluster-port=29015
http-port=8081

bind=all
```

See the [RethinkDB docs](http://www.rethinkdb.com/docs/guides/startup/)
on what the different configuration parameters mean.

## What actually happens
* Installs rethinkdb via its [ppa](http://www.rethinkdb.com/docs/install/)
* Creates a user/group for the rethinkdb service
* Generates a conf file and puts it into `/etc/rethinkdb/instances.d`
* Runs `rethinkdb create -d /var/lib/rethinkdb/instances.d`, which is
  the default directory
* Ensures the `init.d` service will run on startup

